<div class="container">
  <img [src]="event?.imageUrl" [alt]="event?.name" class="event-image">

  <div class="row">
    <div class="col-md-11">
      <h2>{{event?.name | uppercase }} </h2>
    </div>
  </div>

  <div class="row">
    <div class="col-md-6">
      <div><strong>Date:</strong> {{event?.date | date:'short' }}</div>
      <div><strong>Date:</strong> {{event?.date | date:'shortDate' }}</div>
      <div><strong>Date:</strong> {{event?.date | date:'y/M/d' }}</div>
      <div><strong>Time:</strong> {{event?.time}}</div>
      <div><strong>Price:</strong> ${{event?.price}}</div>
    </div>
    <div class="col-md-6">
      <address>
        <strong>Address:</strong><br />
        {{event?.location?.address}}<br />
        {{event?.location?.city}}, {{event?.location?.country}}
      </address>
    </div>
  </div>

  <hr>

  <div class="row" style="margin-bottom:10px">
    <div class="col-md-2">
      <h3 style="margin:0">Sessions</h3>
    </div>
    <div class="col-md-7">
      <div class="btn-group btn-group-sm">
        <button class="btn btn-default" [class.active]="filterBy==='all'" (click)="filterBy='all'">All</button>
        <button class="btn btn-default" [class.active]="filterBy==='beginner'" (click)="filterBy='beginner'">Beginner</button>
        <button class="btn btn-default" [class.active]="filterBy==='intermediate'" (click)="filterBy='intermediate'">Intermediate</button>
        <button class="btn btn-default" [class.active]="filterBy==='advanced'" (click)="filterBy='advanced'">Advanced</button>
      </div>
    </div>
    <div class="col-md-2">
      <a (click)="addSession()">Add Session</a>
    </div>
  </div>

  <session-list [filterBy]="filterBy" *ngIf="!addMode" [sessions]="event?.sessions"></session-list>
  <create-session *ngIf="addMode" (saveNewSession)="saveNewSession($event)" (cancelAddSession)="cancelAddSession()"></create-session>
</div>

<!--
10.06 Filtering Data
So now we need to change the data. We need to pass this setting, this property, filterBy property into the session list that we've got, and down here we've got this session-list component right here that we're passing in a sessions, so since we're already passing in the sessions let's also pass in what the active filter is, and we'll let the session list itself be responsible for the filtering. We'll just tell it what it should be filtered to. So we're going to create a new property binding, and we'll call this filterBy, and we'll set it to our filterBy property. So this right here, is this property here, and this is a property on the session list component, so let's save that and go into our session-list component, and we'll create that input property. We've already got the sessions coming in, so we'll create a new input property, and this is called filterBy and that's a string. And so now we're passing the value into this component, but we need to take action on that value, and we need to change what sessions are being showed when this filterBy property itself changes its value. And there's a great way to do that. There is an interface called OnChanges, and if we implement that interface in our class, then what it wants us to do is implement a method called ngOnChanges. This ngOnChanges method is going to be called every time one of the input variables to this component gets a new value. And that's exactly what we want. We want to be able to react whenever our filterBy value changes. Now the ngOnChanges can actually be called before any of the other data is set, so remember again, that our sessions are being passed in, and we don't want to react and execute any code here in the session list in ngOnChanges event if the sessions haven't been set yet. So we're going to first make a check and we're going to say if this. sessions, which is just a quick and dirty way of saying if we actually have sessions set. If they're not set, this is going to be an undefined value and therefore it'll be faulty so this won't pass. But if it is set, then I want to filter my sessions. So I'm just going to call a method on this same class, named filterSessions. So this dot filterSessions. And I'll just pass in that filterBy setting. Now I don't have to pass in the setting, because it's available on the class, but it does make the method itself stateless, so let's implement that method. filterSessions. I'm going to be passing in our filter value. If the filter's value is set to the value of all, the string of all, then we don't want to do any filtering at all, we just want all of the sessions to be visible. Otherwise, we want to filter our sessions to just the sessions that have a matching level. And the reason I chose those strings is because the data is the same way. It has different casing so we'll have to deal with casing, but that way I can filter to just the sessions that have a matching level. So let's talk about filtering our sessions and what that displays like. We go an look at our session-list. component, and right at the top, we've got this ngFor that says for every session of the sessions variable, we've got a div, or essentially a row. So I want this variable, this list of sessions to be a sub set. Now I don't want to actually go in and modify the sessions property itself, and give it a subset, because then I might lose the entire set of sessions. So I want to leave this alone. Instead, let's create a new property, and we'll call it visibleSessions. It'll also be an array of Isession, and we'll default it to an empty set, and that is what we're going to bind to and display on our page. So go back into the HTML, and instead of sessions, we're now going to be displaying visibleSessions. Save that change. And back here inside of this filterSessions method, that's where we're going to change what the value of the visibleSessions array is. So if the filter is set to all, then we want this. visibleSessions to be all of the sessions. Now you might think that we just want to set it equal to this. Sessions, right? And just set it equal to that variable, but we don't. We want this to be an entirely unique list or duplicate, so we want to really clone the array itself, and there's a quick and easy way to do that with the slice method. We're going to slice it from the very first element, and that creates a complete duplicate of the array with all the same elements. Then in our or else clause, we want to set this. visibleSessions to some sub set of the sessions array. And there's a nice method on arrays called filter, which creates a brand new array and we'll pass in a little lambda. We're going to take in the actual session, and we're going to return the session's level, and let's lowercase that so we're going to go toLocaleLowerCase, and we want to return true if that matches the filter value. And, it will return false if that doesn't match. So anything that matches true or returns true is going to be included in the new array. Anything that returns false will not, so therefore any rows or any sessions that have a level that matches the matching word beginner, intermediate, or advance will then be included in the new visible array, or visibleSessions array. And anything that doesn't is not going to be included. So now we've got a brand new array that's being copied and that's what's being displayed. So let's save those changes, and go back to our HTML and refresh. And we're defaulting to all. Let's just check and make sure, yes it is still displaying all five of those sessions. And let's click beginner. And immediately, you can see that only the beginner session is now visible. Let's click intermediate, and now we're seeing the two intermediate sessions, and advanced. We've got the two advanced sessions and nothing else. And back to all, and we're now viewing all of our sessions. So there's how we can implement filtering ourself inside of our component, and notice that the code did take a little bit of thinking through, but it's very efficient code. Nothing changes unless we take the correct action. So no matter what events we're listening to inside of our application, none of this code is getting run unless we take an action that actually applies to filtering sessions. So, in other words, clicking one of these buttons. Now we implemented this functionality by adding code to the session-list. component, and that's the component that's in charge of displaying the sessions. So all of the logic is essentially inside of there. We didn't have to implement that code there. We could've implemented the code in the parent component inside of the event-details. component. It's really up to us to decide which component is responsible for the filtering. Does the event details just pass a filtered list into the session-list. component or does the session-list. component receive what the filter is and then filter its own view. So is this component a little bit smarter, or a little bit dumber? So really the choices are, is as to where we want to add the logic based on which component we feel like should be responsible for the functionality. There's a couple of homework assignments for this section, so go ahead and do those now.




-->